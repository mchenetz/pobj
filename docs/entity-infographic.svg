<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="860" viewBox="0 0 1400 860" role="img" aria-labelledby="title desc">
  <title id="title">entity COSI S3 Architecture</title>
  <desc id="desc">Infographic of entity operator, COSI flow, clustered object service, TLS and Portworx storage.</desc>

  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f4f8ff"/>
      <stop offset="100%" stop-color="#eef7f3"/>
    </linearGradient>
    <linearGradient id="card" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#ffffff"/>
      <stop offset="100%" stop-color="#f8fbff"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#c8d5e8" flood-opacity="0.45"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,5 L0,10 z" fill="#305f9f"/>
    </marker>
    <style>
      .h1 { font: 700 36px 'Segoe UI', Arial, sans-serif; fill: #13315c; }
      .h2 { font: 700 20px 'Segoe UI', Arial, sans-serif; fill: #13315c; }
      .label { font: 600 15px 'Segoe UI', Arial, sans-serif; fill: #1f3e6d; }
      .small { font: 500 13px 'Segoe UI', Arial, sans-serif; fill: #39557e; }
      .tiny { font: 500 12px 'Segoe UI', Arial, sans-serif; fill: #4a6388; }
      .pill { font: 700 12px 'Segoe UI', Arial, sans-serif; fill: #ffffff; }
    </style>
  </defs>

  <rect x="0" y="0" width="1400" height="860" fill="url(#bg)"/>

  <text x="60" y="66" class="h1">entity: COSI-Compliant Clustered S3 on Kubernetes</text>
  <text x="60" y="96" class="small">Operator-managed object service, COSI provisioning, TLS everywhere, mTLS replication, Portworx-backed PVCs</text>

  <rect x="60" y="130" width="280" height="200" rx="16" fill="url(#card)" stroke="#b8cbe3" filter="url(#shadow)"/>
  <text x="84" y="165" class="h2">Applications</text>
  <text x="84" y="195" class="label">S3 Clients / SDKs</text>
  <text x="84" y="218" class="small">AWS CLI, boto3, app pods</text>
  <text x="84" y="252" class="label">Use Secret Credentials</text>
  <text x="84" y="275" class="small">AWS_ACCESS_KEY_ID, SECRET, CA</text>

  <rect x="380" y="130" width="300" height="200" rx="16" fill="url(#card)" stroke="#b8cbe3" filter="url(#shadow)"/>
  <text x="404" y="165" class="h2">COSI API Layer</text>
  <text x="404" y="195" class="label">BucketClaim / BucketAccess</text>
  <text x="404" y="218" class="small">BucketClass / BucketAccessClass</text>
  <text x="404" y="252" class="label">COSI Driver (entity-cosi)</text>
  <text x="404" y="275" class="small">Creates bucket + access keys + Secrets</text>

  <rect x="720" y="130" width="300" height="200" rx="16" fill="url(#card)" stroke="#b8cbe3" filter="url(#shadow)"/>
  <text x="744" y="165" class="h2">entity Operator</text>
  <text x="744" y="195" class="label">ObjectService Reconciler</text>
  <text x="744" y="218" class="small">StatefulSet + Services + COSI deploy</text>
  <text x="744" y="252" class="label">Certificate Management</text>
  <text x="744" y="275" class="small">Self-signed rotation or cert-manager</text>

  <rect x="1060" y="130" width="280" height="200" rx="16" fill="url(#card)" stroke="#b8cbe3" filter="url(#shadow)"/>
  <text x="1084" y="165" class="h2">Delivery</text>
  <text x="1084" y="195" class="label">GitHub Actions</text>
  <text x="1084" y="218" class="small">Build binaries + image + Helm chart</text>
  <text x="1084" y="252" class="label">GHCR</text>
  <text x="1084" y="275" class="small">Container and Helm OCI registry</text>

  <line x1="340" y1="230" x2="380" y2="230" stroke="#305f9f" stroke-width="3" marker-end="url(#arrow)"/>
  <line x1="680" y1="230" x2="720" y2="230" stroke="#305f9f" stroke-width="3" marker-end="url(#arrow)"/>
  <line x1="1020" y1="230" x2="1060" y2="230" stroke="#305f9f" stroke-width="3" marker-end="url(#arrow)"/>

  <rect x="60" y="370" width="1280" height="420" rx="20" fill="#ffffff" stroke="#9db8dc" filter="url(#shadow)"/>
  <text x="90" y="408" class="h2">Clustered Object Service (ObjectService.spec.replicas = 3+)</text>

  <rect x="92" y="432" width="398" height="120" rx="12" fill="#f4f9ff" stroke="#b8cbe3"/>
  <text x="112" y="458" class="label">Service Endpoints</text>
  <text x="112" y="480" class="tiny">S3 API: HTTPS 9000 (SigV4)</text>
  <text x="112" y="500" class="tiny">Admin API: HTTPS 19000 (Bearer token)</text>
  <text x="112" y="520" class="tiny">Internal replication requires mTLS client cert</text>

  <rect x="510" y="432" width="800" height="330" rx="14" fill="#f7fbf8" stroke="#b8d9c8"/>
  <text x="530" y="458" class="label">StatefulSet Pods</text>

  <rect x="540" y="480" width="230" height="240" rx="10" fill="#ffffff" stroke="#b8d9c8"/>
  <text x="560" y="505" class="label">entity-0</text>
  <text x="560" y="528" class="tiny">Leader elected by health/probe order</text>
  <text x="560" y="548" class="tiny">Handles mutating requests</text>
  <text x="560" y="568" class="tiny">Replicates to followers</text>
  <rect x="560" y="590" width="110" height="24" rx="12" fill="#2b7a4b"/>
  <text x="576" y="607" class="pill">Leader</text>
  <text x="560" y="640" class="tiny">PVC: data-entity-0</text>
  <text x="560" y="660" class="tiny">TLS mount: tls.crt/key + ca.crt</text>

  <rect x="790" y="480" width="230" height="240" rx="10" fill="#ffffff" stroke="#b8d9c8"/>
  <text x="810" y="505" class="label">entity-1</text>
  <text x="810" y="528" class="tiny">Serves reads</text>
  <text x="810" y="548" class="tiny">Accepts replicated writes</text>
  <text x="810" y="568" class="tiny">Validates mTLS peer cert</text>
  <rect x="810" y="590" width="124" height="24" rx="12" fill="#4b86d1"/>
  <text x="828" y="607" class="pill">Follower</text>
  <text x="810" y="640" class="tiny">PVC: data-entity-1</text>
  <text x="810" y="660" class="tiny">TLS mount: tls.crt/key + ca.crt</text>

  <rect x="1040" y="480" width="230" height="240" rx="10" fill="#ffffff" stroke="#b8d9c8"/>
  <text x="1060" y="505" class="label">entity-2</text>
  <text x="1060" y="528" class="tiny">Serves reads</text>
  <text x="1060" y="548" class="tiny">Accepts replicated writes</text>
  <text x="1060" y="568" class="tiny">Quorum ack participant</text>
  <rect x="1060" y="590" width="124" height="24" rx="12" fill="#4b86d1"/>
  <text x="1078" y="607" class="pill">Follower</text>
  <text x="1060" y="640" class="tiny">PVC: data-entity-2</text>
  <text x="1060" y="660" class="tiny">TLS mount: tls.crt/key + ca.crt</text>

  <line x1="655" y1="620" x2="790" y2="620" stroke="#2b7a4b" stroke-width="3" marker-end="url(#arrow)"/>
  <line x1="655" y1="640" x2="1040" y2="640" stroke="#2b7a4b" stroke-width="3" marker-end="url(#arrow)"/>
  <text x="684" y="610" class="tiny">replicate write (mTLS)</text>

  <rect x="92" y="572" width="398" height="190" rx="12" fill="#f4f9ff" stroke="#b8cbe3"/>
  <text x="112" y="598" class="label">Portworx / CSI Block Storage</text>
  <text x="112" y="620" class="tiny">One PVC per pod via StorageClass</text>
  <text x="112" y="640" class="tiny">Persistent object data + metadata</text>
  <text x="112" y="660" class="tiny">Works with px-repl3 and topology policies</text>
  <text x="112" y="690" class="tiny">Write path: Leader local commit + follower quorum ACK</text>
  <text x="112" y="710" class="tiny">Read path: Any replica (eventual consistency window minimized)</text>
  <text x="112" y="740" class="tiny">Security: TLS for external APIs, mTLS for replication, scoped credentials</text>
</svg>
